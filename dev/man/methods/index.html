<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Methods · CovarianceEstimation.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">CovarianceEstimation.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li class="is-active"><a class="tocitem" href>Methods</a><ul class="internal"><li><a class="tocitem" href="#Notations"><span>Notations</span></a></li><li><a class="tocitem" href="#Simple-estimator"><span>Simple estimator</span></a></li><li><a class="tocitem" href="#Linear-shrinkage-estimators"><span>Linear shrinkage estimators</span></a></li><li><a class="tocitem" href="#Nonlinear-shrinkage-estimators"><span>Nonlinear shrinkage estimators</span></a></li><li><a class="tocitem" href="#Biweight-midcovariance"><span>Biweight midcovariance</span></a></li><li><a class="tocitem" href="#Comparing-estimators"><span>Comparing estimators</span></a></li></ul></li><li><a class="tocitem" href="../lshrink/">Linear shrinkage estimators</a></li><li><a class="tocitem" href="../nlshrink/">Nonlinear shrinkage estimators</a></li><li><a class="tocitem" href="../msecomp/">MSE comparisons</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../lib/public/">Public</a></li><li><a class="tocitem" href="../../lib/internals/">Internals</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Methods</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Methods</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/mateuszbaran/CovarianceEstimation.jl/blob/master/docs/src/man/methods.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Methods"><a class="docs-heading-anchor" href="#Methods">Methods</a><a id="Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Methods" title="Permalink"></a></h1><h2 id="Notations"><a class="docs-heading-anchor" href="#Notations">Notations</a><a id="Notations-1"></a><a class="docs-heading-anchor-permalink" href="#Notations" title="Permalink"></a></h2><p>In these docs, <span>$X$</span> denotes an <span>$n\times p$</span> data matrix describing <span>$n$</span> observations with <span>$p$</span> features (variables) and possibly <span>$p &gt; n$</span>. For most estimators, the matrix is assumed to have entries in <span>$\mathbb R$</span>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>While in the docs we assume that the rows of <span>$X$</span> correspond to observations and the columns to features, in the code you can specify this using the <code>dims</code> keyword with <code>dims=1</code> being the default whereas <code>dims=2</code> will take rows as features and columns as observations.</p></div></div><p>We will write <span>$X_c$</span> the <em>centered</em> matrix i.e. where each column sums up to zero. We will also write <span>$X_s$</span> the <em>standardised</em> matrix i.e. where each column not only sums up to zero but is scaled to have sample variance one. Finally, we will write <span>$S$</span> the standard sample covariance estimator (see below) of size <span>$p\times p$</span> and <span>$D$</span> the diagonal matrix matching the diagonal of <span>$S$</span>.</p><p>Note that the sample variance and covariance can be corrected or uncorrected (and this can be specified in the code). In order to avoid having to specify this everywhere in the document, it is useful to introduce a last symbol: <span>$\kappa$</span> which is either set to <span>$n$</span> (uncorrected case) or <span>$(n-1)$</span> (corrected case).</p><p>With these notations we can write:</p><p class="math-container">\[\begin{aligned}
    S &amp;= \kappa^{-1}X_c^T X_c\\
    D_{ij} &amp;= S_{ij}\mathbf 1_{[i=j]}\\
    X_s &amp;= X_c D^{-1/2}
\end{aligned}\]</p><h2 id="Simple-estimator"><a class="docs-heading-anchor" href="#Simple-estimator">Simple estimator</a><a id="Simple-estimator-1"></a><a class="docs-heading-anchor-permalink" href="#Simple-estimator" title="Permalink"></a></h2><p>The standard covariance estimator is easily obtained via the equation above. It can be specified with the constructor <code>SimpleCovariance</code> which can take a named argument <code>corrected</code> (either <code>false</code> (default) or <code>true</code>).</p><pre><code class="language-julia">Random.seed!(1)
n, p = 5, 7
X = randn(n, p)
# corrected covariance
S = cov(SimpleCovariance(corrected=true), X)
# we can also manually compute it and compare
Xc = (X .- sum(X, dims=1)/n) # centering
κ = n-1 # correction factor
S ≈ (Xc&#39;*Xc)/κ</code></pre><pre class="documenter-example-output">true</pre><h2 id="Linear-shrinkage-estimators"><a class="docs-heading-anchor" href="#Linear-shrinkage-estimators">Linear shrinkage estimators</a><a id="Linear-shrinkage-estimators-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-shrinkage-estimators" title="Permalink"></a></h2><p>Linear shrinkage estimators correspond to covariance estimators of the form</p><p class="math-container">\[\hat\Sigma = (1-\lambda)S + \lambda F\]</p><p>where <span>$F$</span> is a <em>target</em> matrix of appropriate dimensions, <span>$\lambda\in[0,1]$</span> is a shrinkage intensity and <span>$S$</span> is the sample covariance estimator. There are several standard targets that can be used, a simple example being the identity matrix.</p><p>The shrinkage intensity <span>$\lambda$</span> can be specified manually or computed automatically. Depending on the target, different approaches are implemented to compute a good intensity such as, for example, the Ledoit-Wolf optimal intensity (which is the default intensity if you don&#39;t specify it).</p><p>You can read more on the targets that can be used and the corresponding automatic intensities <a href="../lshrink/#lshrink">here</a>.</p><p>Here is an example using the identity matrix as a target and automatic shrinkage intensity (Ledoit-Wolfe):</p><pre><code class="language-julia">Random.seed!(1)
n, p = 2, 3
X = randn(n, p)
target = DiagonalUnitVariance()
shrinkage = :lw # Ledoit-Wolf optimal shrinkage
method = LinearShrinkage(target, shrinkage)
cov(method, X)</code></pre><pre class="documenter-example-output">3×3 LinearAlgebra.Symmetric{Float64,Array{Float64,2}}:
 0.00181084  0.0124936  0.0244715
 0.0124936   0.0861978  0.168837
 0.0244715   0.168837   0.330704</pre><p>You can also specify the intensity manually:</p><pre><code class="language-julia">shrinkage = 0.8
method2 = LinearShrinkage(target, shrinkage)
cov(method2, X)</code></pre><pre class="documenter-example-output">3×3 LinearAlgebra.Symmetric{Float64,Array{Float64,2}}:
 0.800362    0.00249872  0.0048943
 0.00249872  0.81724     0.0337674
 0.0048943   0.0337674   0.866141</pre><p><a href="../lshrink/#lshrink">Read more on linear shrinkage estimators...</a></p><h2 id="Nonlinear-shrinkage-estimators"><a class="docs-heading-anchor" href="#Nonlinear-shrinkage-estimators">Nonlinear shrinkage estimators</a><a id="Nonlinear-shrinkage-estimators-1"></a><a class="docs-heading-anchor-permalink" href="#Nonlinear-shrinkage-estimators" title="Permalink"></a></h2><p><a href="../nlshrink/#nlshrink">Read more on nonlinear shrinkage estimators...</a></p><h2 id="Biweight-midcovariance"><a class="docs-heading-anchor" href="#Biweight-midcovariance">Biweight midcovariance</a><a id="Biweight-midcovariance-1"></a><a class="docs-heading-anchor-permalink" href="#Biweight-midcovariance" title="Permalink"></a></h2><p>The biweight midcovariance is a covariance estimator that is resilient to outliers. A full description of the technique is included on <a href="../../lib/public/#CovarianceEstimation.BiweightMidcovariance"><code>BiweightMidcovariance</code></a>.</p><pre><code class="language-julia">Random.seed!(1)
n, p = 10, 3
X = rand(TDist(3), (n, p))  # Moderately heavy-tailed data
cov(BiweightMidcovariance(), X)</code></pre><pre class="documenter-example-output">3×3 Array{Float64,2}:
  0.690036   0.324881  -0.126651
  0.324881   2.90302   -0.438246
 -0.126651  -0.438246   4.83408</pre><p>The two controllable parameters are the keyword arguments <code>c</code> and <code>modify_sample_size</code>, whose purpose is described in the docstring.</p><h2 id="Comparing-estimators"><a class="docs-heading-anchor" href="#Comparing-estimators">Comparing estimators</a><a id="Comparing-estimators-1"></a><a class="docs-heading-anchor-permalink" href="#Comparing-estimators" title="Permalink"></a></h2><p>You may want to look at our simple <a href="../msecomp/#msecomp">comparison of covariance estimators</a> which compares the MSE of the various estimators in a range of situations. Long story short, the <code>LinearShrinkageEstimator</code> with <code>DiagonalUnequalVariance</code> target performs well in the case <span>$n&lt;p$</span> though most other estimators don&#39;t fare too badly in comparison. In the case <span>$n&gt;p$</span>, the nonlinear shrinkage method does very well (though it is more expensive to compute).</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../lshrink/">Linear shrinkage estimators »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 28 November 2023 11:20">Tuesday 28 November 2023</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
