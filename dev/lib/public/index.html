<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Public · CovarianceEstimation.jl</title><meta name="title" content="Public · CovarianceEstimation.jl"/><meta property="og:title" content="Public · CovarianceEstimation.jl"/><meta property="twitter:title" content="Public · CovarianceEstimation.jl"/><meta name="description" content="Documentation for CovarianceEstimation.jl."/><meta property="og:description" content="Documentation for CovarianceEstimation.jl."/><meta property="twitter:description" content="Documentation for CovarianceEstimation.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">CovarianceEstimation.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../man/methods/">Methods</a></li><li><a class="tocitem" href="../../man/lshrink/">Linear shrinkage estimators</a></li><li><a class="tocitem" href="../../man/nlshrink/">Nonlinear shrinkage estimators</a></li><li><a class="tocitem" href="../../man/msecomp/">MSE comparisons</a></li></ul></li><li><span class="tocitem">Library</span><ul><li class="is-active"><a class="tocitem" href>Public</a><ul class="internal"><li><a class="tocitem" href="#Contents"><span>Contents</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li><li><a class="tocitem" href="#Public-Interface"><span>Public Interface</span></a></li></ul></li><li><a class="tocitem" href="../internals/">Internals</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Library</a></li><li class="is-active"><a href>Public</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Public</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mateuszbaran/CovarianceEstimation.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mateuszbaran/CovarianceEstimation.jl/blob/master/docs/src/lib/public.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Public-Documentation"><a class="docs-heading-anchor" href="#Public-Documentation">Public Documentation</a><a id="Public-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Public-Documentation" title="Permalink"></a></h1><p>Documentation for <code>CovarianceEstimation.jl</code>&#39;s public interface.</p><p>See <a href="../internals/#Internal-Documentation">Internal Documentation</a> for internal package docs.</p><h2 id="Contents"><a class="docs-heading-anchor" href="#Contents">Contents</a><a id="Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Contents" title="Permalink"></a></h2><ul><li><a href="#Public-Documentation">Public Documentation</a></li><li class="no-marker"><ul><li><a href="#Contents">Contents</a></li><li><a href="#Index">Index</a></li><li><a href="#Public-Interface">Public Interface</a></li></ul></li></ul><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#CovarianceEstimation.AnalyticalNonlinearShrinkage"><code>CovarianceEstimation.AnalyticalNonlinearShrinkage</code></a></li><li><a href="#CovarianceEstimation.BiweightMidcovariance"><code>CovarianceEstimation.BiweightMidcovariance</code></a></li><li><a href="#CovarianceEstimation.CommonCovariance"><code>CovarianceEstimation.CommonCovariance</code></a></li><li><a href="#CovarianceEstimation.ConstantCorrelation"><code>CovarianceEstimation.ConstantCorrelation</code></a></li><li><a href="#CovarianceEstimation.DiagonalCommonVariance"><code>CovarianceEstimation.DiagonalCommonVariance</code></a></li><li><a href="#CovarianceEstimation.DiagonalUnequalVariance"><code>CovarianceEstimation.DiagonalUnequalVariance</code></a></li><li><a href="#CovarianceEstimation.DiagonalUnitVariance"><code>CovarianceEstimation.DiagonalUnitVariance</code></a></li><li><a href="#CovarianceEstimation.LinearShrinkage"><code>CovarianceEstimation.LinearShrinkage</code></a></li><li><a href="#CovarianceEstimation.NormLossCov"><code>CovarianceEstimation.NormLossCov</code></a></li><li><a href="#CovarianceEstimation.PerfectPositiveCorrelation"><code>CovarianceEstimation.PerfectPositiveCorrelation</code></a></li><li><a href="#CovarianceEstimation.StatLossCov"><code>CovarianceEstimation.StatLossCov</code></a></li><li><a href="#CovarianceEstimation.WoodburyEstimator"><code>CovarianceEstimation.WoodburyEstimator</code></a></li><li><a href="#Statistics.cov"><code>Statistics.cov</code></a></li></ul><h2 id="Public-Interface"><a class="docs-heading-anchor" href="#Public-Interface">Public Interface</a><a id="Public-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Public-Interface" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Statistics.cov" href="#Statistics.cov"><code>Statistics.cov</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">cov(lse::LinearShrinkage, X, [weights::FrequencyWeights]; dims=1, mean=nothing)</code></pre><p>Linear shrinkage covariance estimator for matrix <code>X</code> along dimension <code>dims</code>. Computed using the method described by <code>lse</code>.</p><p>Optionally provide <code>weights</code> associated with each observation in <code>X</code> (see <code>StatsBase.FrequencyWeights</code>).</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>Theoretical guidance for the use of weights in shrinkage estimation seems sparse. <code>FrequencyWeights</code> have a straightforward implementation, but support for other <code>AbstractWeight</code> subtypes awaits analytical justification.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mateuszbaran/CovarianceEstimation.jl/blob/a9ab2209ecfeaa65ae056af9062e30f09d7c352c/src/linearshrinkage.jl#L109-L121">source</a></section><section><div><pre><code class="language-julia hljs">cov(ans::AnalyticalNonlinearShrinkage, X, [weights]; dims=1, mean=nothing)</code></pre><p>Nonlinear covariance estimator derived from the sample covariance estimator <code>S</code> and its eigenvalue decomposition (which can be given through <code>decomp</code>). See Ledoit and Wolf&#39;s paper http://www.econ.uzh.ch/static/wp/econwp264.pdf The keyword <code>mean</code> can be <code>nothing</code> (centering via estimated mean), zero (no centering) or a provided vector. In the first case, a rank-1 modification is applied and therefore the effective sample size is decreased by one (see <code>analytical_nonlinear_shrinkage</code>). In the latter two case the mean cannot have been estimated on the data (otherwise the effective sample size will be 1 larger than it should be resulting in numerical instabilities). If you are unsure, use either <code>nothing</code> or provide an explicit (non-estimated) vector (possibly a zero vector) and avoid the use of <code>mean=0</code>.</p><ul><li>Time complexity (including formation of <code>S</code>)<ul><li>(p&lt;n): O(np^2 + n^2) with moderate constant</li><li>(p&gt;n): O(p^3) with low constant (dominated by eigendecomposition of S)</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mateuszbaran/CovarianceEstimation.jl/blob/a9ab2209ecfeaa65ae056af9062e30f09d7c352c/src/nonlinearshrinkage.jl#L118-L136">source</a></section><section><div><pre><code class="language-julia hljs">cov(estimator::WoodburyEstimator, X::AbstractMatrix, weights::FrequencyWeights...; dims::Int=1, mean=nothing, UsV=nothing)</code></pre><p>Estimate the covariance matrix from the data matrix <code>X</code> using a &quot;spiked&quot; covariance model</p><pre><code class="nohighlight hljs">Σ = σ²I + U * Λ * U&#39;,</code></pre><p>where <code>U</code> is a low-rank matrix of eigenvectors and <code>Λ</code> is a diagonal matrix.</p><p>Reference:     Donoho, D.L., Gavish, M. and Johnstone, I.M., 2018.     Optimal shrinkage of eigenvalues in the spiked covariance model. Annals of statistics, 46(4), p.1742.</p><p>When <code>σ²</code> is not supplied in <code>estimator</code>, it is calculated from the residuals <code>X - X̂</code>, where <code>X̂</code> is the low-rank approximation of <code>X</code> used to generate <code>U</code> and <code>Λ</code>.</p><p>If <code>X</code> is too large to manipulate in memory, you can pass <code>UsV = (U, s, V)</code> (a truncated SVD of <code>X - mean(X; dims)</code>) and then <code>X</code> will only be used compute the dimensionality and number of observations. This requires that you specify <code>estimator.σ²</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mateuszbaran/CovarianceEstimation.jl/blob/a9ab2209ecfeaa65ae056af9062e30f09d7c352c/src/woodbury.jl#L32-L51">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CovarianceEstimation.LinearShrinkage" href="#CovarianceEstimation.LinearShrinkage"><code>CovarianceEstimation.LinearShrinkage</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LinearShrinkage(target, shrinkage; corrected=false, drop_var0=false)</code></pre><p>Linear shrinkage estimator described by equation <span>$(1 - \lambda) S + \lambda F$</span> where <span>$S$</span> is standard covariance matrix, <span>$F$</span> is shrinkage target described by argument <code>target</code> and <span>$\lambda$</span> is a shrinkage parameter, either given explicitly in <code>shrinkage</code> or automatically determined according to one of the supported methods.</p><p>The corrected estimator is used if <code>corrected</code> is true. <code>drop_var0=true</code> drops the zero-variance variables from the computation of <code>\lambda</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mateuszbaran/CovarianceEstimation.jl/blob/a9ab2209ecfeaa65ae056af9062e30f09d7c352c/src/linearshrinkage.jl#L75-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CovarianceEstimation.DiagonalUnitVariance" href="#CovarianceEstimation.DiagonalUnitVariance"><code>CovarianceEstimation.DiagonalUnitVariance</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DiagonalUnitVariance</code></pre><p>Target for linear shrinkage: unit matrix. A subtype of <code>LinearShrinkageTarget</code> where</p><ul><li><span>$F_{ij}=1$</span> if <span>$i=j$</span> and</li><li><span>$F_{ij}=0$</span> otherwise</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mateuszbaran/CovarianceEstimation.jl/blob/a9ab2209ecfeaa65ae056af9062e30f09d7c352c/src/linearshrinkage.jl#L7-L15">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CovarianceEstimation.DiagonalCommonVariance" href="#CovarianceEstimation.DiagonalCommonVariance"><code>CovarianceEstimation.DiagonalCommonVariance</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DiagonalCommonVariance</code></pre><p>Target for linear shrinkage: unit matrix multiplied by average variance of variables. A subtype of <code>LinearShrinkageTarget</code> where</p><ul><li><span>$F_{ij}=v$</span> if <span>$i=j$</span> with <span>$v=\mathrm{tr}(S)/p$</span> and</li><li><span>$F_{ij}=0$</span> otherwise</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mateuszbaran/CovarianceEstimation.jl/blob/a9ab2209ecfeaa65ae056af9062e30f09d7c352c/src/linearshrinkage.jl#L18-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CovarianceEstimation.DiagonalUnequalVariance" href="#CovarianceEstimation.DiagonalUnequalVariance"><code>CovarianceEstimation.DiagonalUnequalVariance</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">DiagonalUnequalVariance</code></pre><p>Target for linear shrinkage: diagonal of covariance matrix. A subtype of <code>LinearShrinkageTarget</code> where</p><ul><li><span>$F_{ij}=s_{ij}$</span> if <span>$i=j$</span> and</li><li><span>$F_{ij}=0$</span> otherwise</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mateuszbaran/CovarianceEstimation.jl/blob/a9ab2209ecfeaa65ae056af9062e30f09d7c352c/src/linearshrinkage.jl#L30-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CovarianceEstimation.CommonCovariance" href="#CovarianceEstimation.CommonCovariance"><code>CovarianceEstimation.CommonCovariance</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">CommonCovariance</code></pre><p>Target for linear shrinkage: see <code>target_C</code>. A subtype of <code>LinearShrinkageTarget</code> where</p><ul><li><span>$F_{ij}=v$</span> if <span>$i=j$</span> with <span>$v=\mathrm{tr}(S)/p$</span> and</li><li><span>$F_{ij}=c$</span> with <span>$c=\sum_{i\neq j} S_{ij}/(p(p-1))$</span> otherwise</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mateuszbaran/CovarianceEstimation.jl/blob/a9ab2209ecfeaa65ae056af9062e30f09d7c352c/src/linearshrinkage.jl#L41-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CovarianceEstimation.PerfectPositiveCorrelation" href="#CovarianceEstimation.PerfectPositiveCorrelation"><code>CovarianceEstimation.PerfectPositiveCorrelation</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PerfectPositiveCorrelation</code></pre><p>Target for linear shrinkage: see <code>target_E</code>. A subtype of <code>LinearShrinkageTarget</code> where</p><ul><li><span>$F_{ij}=S_{ij}$</span> if <span>$i=j$</span> and</li><li><span>$F_{ij}=\sqrt{S_{ii}S_{jj}}$</span> otherwise</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mateuszbaran/CovarianceEstimation.jl/blob/a9ab2209ecfeaa65ae056af9062e30f09d7c352c/src/linearshrinkage.jl#L52-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CovarianceEstimation.ConstantCorrelation" href="#CovarianceEstimation.ConstantCorrelation"><code>CovarianceEstimation.ConstantCorrelation</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ConstantCorrelation</code></pre><p>Target for linear shrinkage: see <code>target_F</code>. A subtype of <code>LinearShrinkageTarget</code> where</p><ul><li><span>$F_{ij}=S_{ij}$</span> if <span>$i=j$</span> and</li><li><span>$F_{ij}=\overline{r}\sqrt{S_{ii}S_{jj}}$</span> otherwise where <span>$\overline{r}$</span> is the average sample correlation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mateuszbaran/CovarianceEstimation.jl/blob/a9ab2209ecfeaa65ae056af9062e30f09d7c352c/src/linearshrinkage.jl#L63-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CovarianceEstimation.AnalyticalNonlinearShrinkage" href="#CovarianceEstimation.AnalyticalNonlinearShrinkage"><code>CovarianceEstimation.AnalyticalNonlinearShrinkage</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AnalyticalNonlinearShrinkage</code></pre><p>Analytical nonlinear shrinkage estimator. See docs for <code>analytical_nonlinear_shrinkage</code> for details.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mateuszbaran/CovarianceEstimation.jl/blob/a9ab2209ecfeaa65ae056af9062e30f09d7c352c/src/nonlinearshrinkage.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CovarianceEstimation.BiweightMidcovariance" href="#CovarianceEstimation.BiweightMidcovariance"><code>CovarianceEstimation.BiweightMidcovariance</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">BiweightMidcovariance(; c=9.0, modify_sample_size=false)</code></pre><p>The biweight midcovariance is a covariance estimator that is resilient to outliers.</p><p>The technique derives originally from astrophysics [1], and is implemented in the Python module <a href="https://www.astropy.org/">Astropy</a> [2], as well as in NIST&#39;s Dataplot [3].</p><p>Consider two random variables <span>$x$</span> and <span>$y$</span>, for which we have <span>$n$</span> observations <span>$\{(x_i, y_i)\}$</span>. The biweight midcovariance is then defined to be:</p><p class="math-container">\[n_s\cdot\frac{
    \sum_{|u_i|&lt;1,|v_i|&lt;1}(x_i - M_x)(1 - u_i^2)^2(y_i - M_y)(1 - v_i^2)^2
}{
    \left(\sum_{|u_i|&lt;1}(1 - u_i^2)(1-5u_i^2)\right)
    \left(\sum_{|v_i|&lt;1}(1 - v_i^2)(1-5v_i^2)\right)
}\]</p><p>where <span>$n_s$</span> is the sample size, <span>$M_x$</span> and <span>$M_y$</span> are the medians of <span>$\{x_i\}$</span> and <span>$\{y_i\}$</span> respectively, and</p><p class="math-container">\[\begin{aligned}
u_i &amp;= \frac{x_i - M_x}{c \cdot \mathrm{MAD}_x} \\
v_i &amp;= \frac{y_i - M_y}{c \cdot \mathrm{MAD}_y},
\end{aligned}\]</p><p>where <span>$\mathrm{MAD}$</span> represents the median absolute deviation,</p><p class="math-container">\[\begin{aligned}
\mathrm{MAD}_x &amp;= \mathrm{median}(\left\{\left|x_i - M_x\right|\right\}) \\
\mathrm{MAD}_y &amp;= \mathrm{median}(\left\{\left|y_i - M_y\right|\right\}).
\end{aligned}\]</p><p>If either <span>$\mathrm{MAD}_x = 0$</span> or <span>$\mathrm{MAD}_y = 0$</span>, the pairwise covariance is defined to be zero.</p><p>The parameter <span>$c$</span> is a tuning constant, for which the default is <span>$9.0$</span>. Larger values will reduce the number of outliers that are removed — i.e. reducing robustness, but increasing sample efficiency.</p><p><strong>Fields</strong></p><ul><li><code>c::Float64</code>: The tuning constant corresponding to <span>$c$</span> above.</li><li><code>modify_sample_size::Bool</code>: If <code>false</code>, then we use a sample size <span>$n_s$</span> equal to the   total number of observations <span>$n$</span>. This is consistent with the standard definition of   biweight midcovariance in the literature. Otherwise, we count only those elements which   are not rejected as outliers in the numerator, i.e. those for which <span>$|u_i|&lt;1$</span>   and <span>$|v_i|&lt;1$</span>.   This follows the implementation in astropy [2].</li></ul><p><strong>Complexity</strong></p><ul><li>Space: <span>$O(p^2)$</span></li><li>Time: <span>$O(np^2)$</span></li></ul><p><strong>References</strong></p><p>[1] Beers, Flynn, and Gebhardt (1990; AJ 100, 32) &quot;Measures of Location and Scale for Velocities in Clusters of Galaxies – A Robust Approach&quot;</p><p>[2] <a href="https://docs.astropy.org/en/stable/api/astropy.stats.biweight_midcovariance.html">Astropy biweight_midcovariance</a></p><p>[3] <a href="https://www.itl.nist.gov/div898/software/dataplot/refman2/auxillar/biwmidc.htm">NIST Dataplot biweight midcovariance</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mateuszbaran/CovarianceEstimation.jl/blob/a9ab2209ecfeaa65ae056af9062e30f09d7c352c/src/biweight.jl#L1-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CovarianceEstimation.NormLossCov" href="#CovarianceEstimation.NormLossCov"><code>CovarianceEstimation.NormLossCov</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">NormLossCov(norm::Symbol, pivotidx::Int)</code></pre><p>Specify a loss function for which the estimated covariance will be optimal. <code>norm</code> is one of <code>:L1</code>, <code>:L2</code>, or <code>:Linf</code>, and <code>pivotidx</code> is an integer from 1 to 7, as specified in Table 1 (p. 1755) of Donoho et al. (2018). In the table below, <code>A</code> and <code>B</code> are the target and sample covariances, respectively, and the loss function is the specified norm on the quantity in the <code>pivot</code> column:</p><table><tr><th style="text-align: right"><code>pivotidx</code></th><th style="text-align: right"><code>pivot</code></th><th style="text-align: right">Notes</th></tr><tr><td style="text-align: right">1</td><td style="text-align: right"><code>A - B</code></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">2</td><td style="text-align: right"><code>A⁻¹ - B⁻¹</code></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">3</td><td style="text-align: right"><code>A⁻¹ B - I</code></td><td style="text-align: right">Not available for <code>:L1</code></td></tr><tr><td style="text-align: right">4</td><td style="text-align: right"><code>B⁻¹ A - I</code></td><td style="text-align: right">Not available for <code>:L1</code></td></tr><tr><td style="text-align: right">5</td><td style="text-align: right"><code>A⁻¹ B + B⁻¹ A - 2I</code></td><td style="text-align: right">Not supported</td></tr><tr><td style="text-align: right">6</td><td style="text-align: right"><code>sqrt(A) \ B / sqrt(A) - I</code></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">7</td><td style="text-align: right"><code>log(sqrt(A) \ B / sqrt(A))</code></td><td style="text-align: right">Not supported</td></tr></table><p>See also <a href="#CovarianceEstimation.StatLossCov"><code>StatLossCov</code></a>.</p><p>Reference:     Donoho, D.L., Gavish, M. and Johnstone, I.M., 2018.     Optimal shrinkage of eigenvalues in the spiked covariance model. Annals of statistics, 46(4), p.1742.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mateuszbaran/CovarianceEstimation.jl/blob/a9ab2209ecfeaa65ae056af9062e30f09d7c352c/src/loss.jl#L16-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CovarianceEstimation.StatLossCov" href="#CovarianceEstimation.StatLossCov"><code>CovarianceEstimation.StatLossCov</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">StatLossCov(mode::Symbol)</code></pre><p>Specify a loss function for which the estimated covariance will be optimal. <code>mode</code> is one of <code>:st</code>, <code>:ent</code>, <code>:div</code>, <code>:aff</code>, or <code>:fre</code>, as specified in Table 2 (p. 1757) of Donoho et al. (2018). In the table below, <code>A</code> and <code>B</code> are the target and sample covariances, respectively:</p><table><tr><th style="text-align: right"><code>mode</code></th><th style="text-align: right">loss</th><th style="text-align: right">Interpretation</th></tr><tr><td style="text-align: right"><code>:st</code></td><td style="text-align: right"><code>st(A, B) = tr(A⁻¹ B - I) - log(det(B)/det(A))</code></td><td style="text-align: right">Minimize `2 Dₖₗ(N(0, B)</td></tr><tr><td style="text-align: right"><code>:ent</code></td><td style="text-align: right"><code>st(B, A)</code></td><td style="text-align: right">Minimize errors in Mahalanobis distances</td></tr><tr><td style="text-align: right"><code>:div</code></td><td style="text-align: right"><code>st(A, B) + st(B, A)</code></td><td style="text-align: right"></td></tr><tr><td style="text-align: right"><code>:aff</code></td><td style="text-align: right"><code>0.5 * log(det(A + B) / (2 * sqrt(det(A*B))))</code></td><td style="text-align: right">Minimize Hellinger distance between <code>N(0, A)</code> and <code>N(0, B)</code></td></tr><tr><td style="text-align: right"><code>:fre</code></td><td style="text-align: right"><code>tr(A + B - 2sqrt(A*B))</code></td><td style="text-align: right"></td></tr></table></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mateuszbaran/CovarianceEstimation.jl/blob/a9ab2209ecfeaa65ae056af9062e30f09d7c352c/src/loss.jl#L52-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="CovarianceEstimation.WoodburyEstimator" href="#CovarianceEstimation.WoodburyEstimator"><code>CovarianceEstimation.WoodburyEstimator</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">WoodburyEstimator(loss::LossFunction, rank::Integer;
                  σ²::Union{Real,Nothing}=nothing, corrected::Bool=false)</code></pre><p>Specify that covariance matrices should be estimated using a &quot;spiked&quot; covariance model</p><pre><code class="nohighlight hljs">Σ = σ²I + U * Λ * U&#39;</code></pre><p><code>loss</code> is either a <a href="#CovarianceEstimation.NormLossCov"><code>NormLossCov</code></a> or <a href="#CovarianceEstimation.StatLossCov"><code>StatLossCov</code></a> object, which specifies the loss function for which the estimated covariance will be optimal. <code>rank</code> is the maximum number of eigenvalues <code>Λ</code> to retain in the model. Optionally, one may specify <code>σ²</code> directly, or it can be estimated from the data matrix (<code>σ²=nothing</code>). Set <code>corrected=true</code> to use the unbiased estimator of the variance.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mateuszbaran/CovarianceEstimation.jl/blob/a9ab2209ecfeaa65ae056af9062e30f09d7c352c/src/woodbury.jl#L9-L22">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../man/msecomp/">« MSE comparisons</a><a class="docs-footer-nextpage" href="../internals/">Internals »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Tuesday 9 January 2024 10:22">Tuesday 9 January 2024</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
